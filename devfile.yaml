apiVersion: 1.0.0
metadata:
  name: podtato-head
projects:
  - name: podtato-head
    source:
      location: https://github.com/joshgav/podtato-head.git
      type: git
      branch: devfile
    clonePath: src/podtato-head
components:
  - type: chePlugin
    alias: ms-vscode.go
    id: golang/go/latest
    memoryLimit: 1G
    preferences:
      go.lintFlags: '--fast'
      go.useLanguageServer: true
      go.lintTool: golangci-lint
    env:
      - value: on
        name: GO111MODULE
  - type: dockerimage
    alias: dev
    mountSources: true
    memoryLimit: 1G
    image: quay.io/eclipse/che-golang-1.17:73ee9d9
    env:
      - value: /go
        name: GOPATH
      - value: /tmp/.cache
        name: GOCACHE
commands:
  - name: Build images
    actions:
      - workdir: /projects/src/podtato-head
        type: exec
        command: make build-microservices-images
        component: dev
  - name: Build binary
    actions:
      - workdir: /projects/src/podtato-head/podtato-head-microservices
        type: exec
        command: go build ./cmd/entry
        component: dev